version: 0.1
runson: linux
concurrency: 3
maxRetries: 1

globalTimeout: 30
testSuiteTimeout: 20
testSuiteStep: 300

# Optional: enable Playwright debug logs
env:
  DEBUG: "pw:api,pw:loader"

# Pre-test setup
pre:
  - echo "ðŸ“¦ Installing dependencies..."
  - npm ci
  - echo "ðŸ§© Installing Playwright browsers..."
  - npx playwright install --with-deps
  - echo "âœ… Pre-test setup completed."

# Discover Playwright tests dynamically
testDiscovery:
  type: raw
  mode: dynamic
  command: npx playwright test --list --reporter=list

# Command to run tests
testRunnerCommand: npx playwright test

# âœ… Post-test diagnostics 
post:
  - echo "ðŸ§¾ Diagnostic check: Counting total test cases..."
  - >
    npx playwright test --list | tee testlist.txt &&
    echo "Total tests found:" $(grep -c "â€º" testlist.txt || echo "0") &&
    echo "âœ… Discovery verification completed."
